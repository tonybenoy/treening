<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Treening - Simple, Private Workout Tracker</title>
    <meta name="description" content="A simple, privacy-focused workout tracker. Log your exercises, track your progress, and manage your fitness routines without any tracking or data collection." />
    <meta name="keywords" content="workout tracker, fitness app, exercise log, private fitness, open source workout, gym logger, free workout app, offline workout tracker, no sign up, no account, free fitness app, open source fitness, bodyweight tracker, gym log app" />
    <meta name="author" content="Tony Benoy" />

    <link rel="canonical" href="https://treen.ing/" />

    <!-- Structured Data (Schema.org) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Treening",
        "description": "A simple, privacy-focused workout tracker. Log your exercises, track your progress, and manage your fitness routines without any tracking or data collection.",
        "url": "https://treen.ing/",
        "applicationCategory": "HealthApplication",
        "operatingSystem": "Any (Web Browser)",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Person",
            "name": "Tony Benoy"
        },
        "license": "https://opensource.org/licenses/MIT",
        "isAccessibleForFree": true,
        "featureList": [
            "Offline workout tracking",
            "No account required",
            "Privacy-focused - no data collection",
            "Exercise logging with sets, reps, and weights",
            "Progress analytics and charts",
            "Peer-to-peer data sync",
            "Open source"
        ]
    }
    </script>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://treen.ing/" />
    <meta property="og:title" content="Treening - Simple, Private Workout Tracker" />
    <meta property="og:description" content="Log your exercises and track your progress with Treening. Simple, private, and effective." />
    <meta property="og:image" content="https://treen.ing/icons/icon-512.svg" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://treen.ing/" />
    <meta property="twitter:title" content="Treening - Simple, Private Workout Tracker" />
    <meta property="twitter:description" content="Log your exercises and track your progress with Treening. Simple, private, and effective." />
    <meta property="twitter:image" content="https://treen.ing/icons/icon-512.svg" />

    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#1e40af" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="icon" type="image/svg+xml" href="icons/icon-512.svg" />
    <link rel="apple-touch-icon" href="icons/icon-192.svg" />

    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>

    <link data-trunk rel="rust" data-wasm-opt="z" />
    <link data-trunk rel="copy-file" href="sw.js" />
    <link data-trunk rel="copy-file" href="manifest.json" />
    <link data-trunk rel="copy-dir" href="icons" data-target-path="icons" />
    <link data-trunk rel="copy-file" href="robots.txt" />
    <link data-trunk rel="copy-file" href="sitemap.xml" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        'primary-light': '#3b82f6',
                        accent: '#f59e0b',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            overscroll-behavior: none;
            -webkit-tap-highlight-color: transparent;
        }
        @media (display-mode: standalone) {
            body { padding-top: env(safe-area-inset-top); }
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        /* Theme transition - applied temporarily during theme switches */
        .theme-transitioning * {
            transition: background-color 300ms, color 300ms, border-color 300ms !important;
        }
        /* Page enter animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .page-enter { animation: fadeIn 150ms ease-out; }
        /* Modal animations */
        @keyframes modalOverlayIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .modal-overlay-enter { animation: modalOverlayIn 150ms ease-out; }
        @keyframes modalContentIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-content-enter { animation: modalContentIn 200ms ease-out; }
        /* Button press feedback */
        .btn-press { transition: transform 100ms ease; }
        .btn-press:active { transform: scale(0.97); }
        /* List item stagger animation */
        @keyframes listItemIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .list-item-enter { animation: listItemIn 200ms ease-out both; }
        /* AMOLED Black theme overrides */
        .amoled .bg-gray-900 { background-color: #000000 !important; }
        .amoled .bg-gray-800 { background-color: #121212 !important; }
        .amoled .bg-gray-700 { background-color: #1e1e1e !important; }
        .amoled .dark\:bg-gray-900 { background-color: #000000 !important; }
        .amoled .dark\:bg-gray-800 { background-color: #121212 !important; }
        .amoled .dark\:bg-gray-700 { background-color: #1e1e1e !important; }
        /* Treen (Wood) theme overrides */
        .treen { --treen-bg: #2c1810; --treen-surface: #3d2317; --treen-accent: #daa520; --treen-text: #faebd7; }
        .treen .bg-gray-900, .treen .dark\:bg-gray-900 { background-color: #2c1810 !important; }
        .treen .bg-gray-800, .treen .dark\:bg-gray-800 { background-color: #3d2317 !important; }
        .treen .dark\:bg-gray-800\/50 { background-color: rgba(61,35,23,0.5) !important; }
        .treen .bg-gray-700, .treen .dark\:bg-gray-700 { background-color: #4a2d1e !important; }
        .treen .text-white, .treen .dark\:text-white { color: #faebd7 !important; }
        .treen .dark\:text-gray-100, .treen .dark\:text-gray-200 { color: #faebd7 !important; }
        .treen .dark\:text-gray-400 { color: #c4a882 !important; }
        .treen .dark\:text-gray-500 { color: #a08060 !important; }
        .treen .dark\:text-gray-600 { color: #8a6a50 !important; }
        .treen .dark\:border-gray-700\/50 { border-color: rgba(74,45,30,0.5) !important; }
        .treen .dark\:border-gray-800 { border-color: #3d2317 !important; }
        .treen .bg-blue-600 { background-color: #daa520 !important; }
        .treen .hover\:bg-blue-700:hover { background-color: #c4941c !important; }
        .treen .active\:bg-blue-800:active { background-color: #b08518 !important; }
        .treen .text-blue-600, .treen .dark\:text-blue-400 { color: #daa520 !important; }
        .treen .dark\:bg-blue-600\/20 { background-color: rgba(218,165,32,0.2) !important; }
        .treen .bg-blue-100, .treen .dark\:bg-blue-900\/40 { background-color: rgba(218,165,32,0.15) !important; }
        .treen .shadow-blue-900\/20 { --tw-shadow-color: rgba(44,24,16,0.3) !important; }
    </style>
    <script>
        // Capture beforeinstallprompt early (before Yew replaces body)
        let deferredPrompt = null;
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (!isStandalone && !localStorage.getItem('install-dismissed')) {
                showInstallBanner();
            }
        });

        function showInstallBanner() {
            if (document.getElementById('install-banner')) return;
            const banner = document.createElement('div');
            banner.id = 'install-banner';
            banner.style.cssText = 'position:fixed; bottom:70px; left:12px; right:12px; z-index:9999; background:linear-gradient(135deg,#1e40af,#3b82f6); color:white; padding:14px 16px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.3); font-family:system-ui,sans-serif; animation:slideUp 0.3s ease-out;';
            banner.innerHTML = '<div style="display:flex; align-items:center; gap:12px;">'
                + '<div style="flex:1;">'
                + '<div style="font-weight:600; font-size:15px;">Install Treening</div>'
                + '<div style="font-size:13px; opacity:0.9; margin-top:2px;">Add to home screen for offline use</div>'
                + '</div>'
                + '<button id="install-btn" style="background:white; color:#1e40af; border:none; padding:8px 16px; border-radius:8px; font-weight:600; font-size:14px; cursor:pointer; white-space:nowrap;">Install</button>'
                + '<button id="install-dismiss" style="background:none; border:none; color:white; opacity:0.7; font-size:20px; cursor:pointer; padding:4px 8px; line-height:1;">&times;</button>'
                + '</div>';
            document.body.appendChild(banner);

            document.getElementById('install-btn').addEventListener('click', async () => {
                if (!deferredPrompt) return;
                deferredPrompt.prompt();
                const result = await deferredPrompt.userChoice;
                if (result.outcome === 'accepted') banner.remove();
                deferredPrompt = null;
            });

            document.getElementById('install-dismiss').addEventListener('click', () => {
                banner.remove();
                localStorage.setItem('install-dismissed', 'true');
            });
        }

        window.addEventListener('appinstalled', () => {
            const b = document.getElementById('install-banner');
            if (b) b.remove();
            deferredPrompt = null;
        });

        // Exposed for Rust/WASM to call
        window.canInstallApp = () => !!deferredPrompt && !isStandalone;
        window.isAppStandalone = () => isStandalone;
        window.isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        window.triggerInstallPrompt = async () => {
            if (!deferredPrompt) return false;
            deferredPrompt.prompt();
            const result = await deferredPrompt.userChoice;
            deferredPrompt = null;
            return result.outcome === 'accepted';
        };

        window.getAppVersion = async () => {
            try {
                const keys = await caches.keys();
                const match = keys.find(k => k.startsWith('treening-'));
                return match ? match.replace('treening-', '') : 'dev';
            } catch { return 'dev'; }
        };

        // Service Worker registration
        if ('serviceWorker' in navigator) {
            // Listen for update messages from new SW
            navigator.serviceWorker.addEventListener('message', event => {
                if (event.data && event.data.type === 'SW_UPDATED') {
                    window.location.reload();
                }
            });

            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => {
                        console.log('SW registered:', reg.scope);
                        // Check for updates every 30 minutes
                        setInterval(() => reg.update(), 30 * 60 * 1000);
                        // Also check on visibility change (user returns to app)
                        document.addEventListener('visibilitychange', () => {
                            if (document.visibilityState === 'visible') reg.update();
                        });
                    })
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
</head>
<body class="transition-colors duration-200">
</body>
</html>
